{% load static %}
{% load templatetags %}
{% if online|length > 0 %}
    <div class="bloc">
        <div class="cattitle">
            <i class="fa-solid fa-user-group" style="margin-right: 0.5em"></i>
            <a href="#">Qui est en ligne ?</a>
        </div>
        <div class="blocwrapper">
        {% for group_data in online_users_with_groups %}
            <div style="display: flex; width: 100%; gap: 2em; align-items: center">
                <div style="flex: 1; font-weight: 900; font-size: 1em; line-height: 1.5em;">
                    <div style="background-color: {{group_data.group.color}}; height: 1.2em; width: 1.2em; display: inline-block; border-radius: 2em; vertical-align: -0.2em; margin-right: 0.2em; overflow: hidden;">
                        <div style="display: inline-block; height: inherit; width: inherit; background: linear-gradient(133deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 50%, rgba(0,0,0,0.3) 100%);"></div>
                    </div>
                    <a href="{% url 'groups-details' group_data.group.id %}" class="clickupdated" onclick="">{{group_data.group.name}}</a>
                </div>
            </div>
            {% if group_data.users %}
            <div class="onlinemembergroup">
                {% for user in group_data.users %}
                    <div>
                        <div class="onlinelistmembermain simpleBackgroundFocus autoUserPopupAnchor" style="width: auto; margin-left: calc(0em - var(--padding-left-right-remove)); margin-right: calc(0em - var(--padding-left-right-remove)); padding-left: var(--padding-left-right-remove); padding-right: var(--padding-left-right-remove)">
                            <div style="font-size: 1.2em; position: relative;" class="">
                                {% if user.profile.profile_picture %}
                                    <div class="avatar avataronline autoUserPopup" userid="{{user.id}}" style="background-image: url({{user.profile.profile_picture.url}});"></div>
                                {% else %} 
                                    {% get_user_random_color username=user.username as random_color %}
                                    <div class="avatar avataronline autoUserPopup empty" userid="{{user.id}}" style="background-color: {{random_color}}; color: rgba(255, 255, 255, 0.7);">{{user.username|slice:":1"|upper}}</div>
                                {% endif %}
                            </div>
                            <div class="onlinelistmember" style="width: 100%; display: flex; justify-content: space-between; align-items: center">
                                <div class="username" style="font-weight: bold">
                                    <a href="{% url 'profile-details' user.id %}" class="clickupdated autoUserPopup" userid="{{user.id}}" style="position: relative;" onclick="">{{user.username}}</a>
                                    {% if user.profile.desc %}
                                    <div>
                                        <div class="profileStatus profileStatusOnlineUsers" style="font-size: 0.8em;">
                                            <div class="psPicto">
                                                <div class="psStatus">{{user.profile.desc}}</div>
                                            </div>
                                            <div class="psB1"></div>
                                            <div class="psB2"></div>
                                            <div class="psB3"></div>
                                        </div>
                                    </div>
                                    {% endif %}
                                </div>
                                <div style="font-size: 0.9em;">
                                    <span timestamp="{{user.profile.last_login|timestamp}}" style="opacity: 0.5;" title="{{user.profile.last_login|timestamp}}">{{user.profile.last_login|timestamp}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
            {% endif %}
        {% endfor %}

            {% comment %} <div class="onlinemembergroup">
                <div style="display: flex;">
                    <div class="onlinelistmembermain">
                        <div style="font-size: 1.2em">
                            <div class="avatar empty" style="background-color: var(--var-th-color); color: var(--var-th-color-contrast);">
                                <span style="font-size: 0.7em; vertical-align: 0.2em; font-weight: 100; padding-right: 0.2em;">+<b>16</b></span>
                            </div>
                        </div>
                        <div class="onlinelistmember">
                            <div class="username">
                                <i class="fa-solid fa-user-ninja"></i> invit√©s
                            </div>
                        </div>
                    </div>
                </div>
            </div> {% endcomment %}

        </div>
    </div>
{% endif %}